# 🐍 Snake Game con almacenamiento en la nube (Supabase)

Este proyecto implementa un **juego Snake en Python (Pygame)** que **registra automáticamente el puntaje en una base de datos en la nube Supabase** (PostgreSQL con API REST).

Permite guardar los puntajes de diferentes jugadores y consultarlos fácilmente desde el panel web o mediante peticiones REST.

---

## 🚀 Características

✅ Juego gráfico con **Pygame**  
✅ Control con teclas de dirección (↑ ↓ ← →)  
✅ Registro automático del puntaje final en **Supabase**  
✅ Base de datos en la nube gratuita  
✅ Código limpio, modular y fácil de extender  

---

## 🧩 Tecnologías

- Python 3.10+
- Pygame
- Supabase
- Requests (HTTP API)

---

## 📁 Estructura del proyecto

```
snake_cloud/
│
├── main.py              # Juego principal
├── supabase_config.py   # Configuración de conexión
└── requirements.txt     # Dependencias del proyecto
```

---

## ⚙️ Instalación y configuración

### 1️⃣ Clonar o descargar el proyecto

```bash
git clone https://github.com/tuusuario/snake_cloud.git
cd snake_cloud
```

### 2️⃣ Instalar dependencias

```bash
pip install -r requirements.txt
```

Contenido de **requirements.txt**:

```txt
pygame
requests
```

### 3️⃣ Crear base de datos en Supabase

1. Ingresa a https://supabase.com y crea una cuenta gratuita.  
2. Crea un nuevo proyecto y anota:
   - **Project URL**
   - **anon public key**
3. En el panel de Supabase → SQL Editor, ejecuta:

```sql
create table scores (
  id bigint generated by default as identity primary key,
  player text,
  score int,
  created_at timestamp default now()
);
```

4. Copia los datos del proyecto y configúralos en el archivo:

---

### 4️⃣ Archivo `supabase_config.py`

```python
SUPABASE_URL = "https://TU-PROYECTO.supabase.co"
SUPABASE_KEY = "TU-CLAVE-ANON"
SUPABASE_TABLE = "scores"
```

---

## 🎮 Código del juego (`main.py`)

```python
import pygame, sys, random, requests
from supabase_config import SUPABASE_URL, SUPABASE_KEY, SUPABASE_TABLE

pygame.init()
WIDTH, HEIGHT = 600, 400
CELL = 20
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("🐍 Snake con Supabase")
clock = pygame.time.Clock()
font = pygame.font.SysFont("consolas", 25)

def subir_puntaje(nombre, puntaje):
    try:
        data = {"player": nombre, "score": puntaje}
        headers = {
            "apikey": SUPABASE_KEY,
            "Authorization": f"Bearer {SUPABASE_KEY}",
            "Content-Type": "application/json"
        }
        r = requests.post(f"{SUPABASE_URL}/rest/v1/{SUPABASE_TABLE}", json=data, headers=headers)
        if r.status_code in (200, 201):
            print("✅ Puntaje registrado en la nube!")
        else:
            print(f"⚠️ Error al registrar puntaje: {r.text}")
    except Exception as e:
        print(f"❌ No se pudo conectar a Supabase: {e}")

def dibujar_snake(snake):
    for segment in snake:
        pygame.draw.rect(screen, (0, 255, 0), (*segment, CELL, CELL))

def dibujar_food(food):
    pygame.draw.rect(screen, (255, 0, 0), (*food, CELL, CELL))

def main():
    snake = [(100, 100), (80, 100), (60, 100)]
    direction = (CELL, 0)
    food = (random.randrange(0, WIDTH, CELL), random.randrange(0, HEIGHT, CELL))
    score = 0
    player = input("👤 Nombre del jugador: ")

    while True:
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                pygame.quit()
                sys.exit()
            if event.type == pygame.KEYDOWN:
                if event.key == pygame.K_UP and direction != (0, CELL):
                    direction = (0, -CELL)
                if event.key == pygame.K_DOWN and direction != (0, -CELL):
                    direction = (0, CELL)
                if event.key == pygame.K_LEFT and direction != (CELL, 0):
                    direction = (-CELL, 0)
                if event.key == pygame.K_RIGHT and direction != (-CELL, 0):
                    direction = (CELL, 0)

        new_head = (snake[0][0] + direction[0], snake[0][1] + direction[1])
        snake.insert(0, new_head)

        if new_head == food:
            score += 10
            food = (random.randrange(0, WIDTH, CELL), random.randrange(0, HEIGHT, CELL))
        else:
            snake.pop()

        if (
            new_head[0] < 0 or new_head[0] >= WIDTH or
            new_head[1] < 0 or new_head[1] >= HEIGHT or
            new_head in snake[1:]
        ):
            print(f"💀 Juego terminado. Puntaje final: {score}")
            subir_puntaje(player, score)
            pygame.quit()
            sys.exit()

        screen.fill((0, 0, 0))
        dibujar_snake(snake)
        dibujar_food(food)
        texto = font.render(f"Puntaje: {score}", True, (255, 255, 255))
        screen.blit(texto, (10, 10))
        pygame.display.flip()
        clock.tick(10)

if __name__ == "__main__":
    main()
```

---

## 🕹️ Ejecución

```bash
python main.py
```

- Mueve la serpiente con las flechas del teclado.  
- Cada comida suma 10 puntos.  
- Cuando pierdes, tu puntaje se guarda automáticamente en la nube.

---

## 📊 Consultar puntajes

Desde Supabase → **Table Editor → scores**  
o vía API REST:

```bash
curl "https://TU-PROYECTO.supabase.co/rest/v1/scores?select=*"   -H "apikey: TU-CLAVE-ANON"
```

---

## 🧠 Posibles mejoras

- Ranking global
- Sonido y efectos visuales
- Guardar puntaje local + nube

---

## 🧑‍💻 Autor

**Giovanny Alejandro Tapiero Cataño**  
Proyecto educativo en Python + Supabase.

---

## 🪪 Licencia

MIT License
